<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Ladang Bukit Serok - Plantation and Agronomy Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .details-content { display: none; }
        .details-content.active { display: block; }
        .dropdown-btn.active { background-color: #14532d; }
        .policy-item { border-left: 3px solid #16a34a; padding-left: 1rem; margin-top: 0.75rem; }
        .modal { display: none; }
        .modal.active { display: flex; }
        .chart-container { position: relative; height: 300px; width: 100%; margin: auto; }
        .pie-chart-container { position: relative; height: 350px; width: 100%; margin: auto; }
        .observation-ref { font-size: 0.75rem; color: #57534e; font-style: italic; }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-md">
        <nav class="container mx-auto px-6 py-4 flex items-center justify-between">
            <div class="text-xl font-bold text-gray-900">
                <a href="../index.html" class="flex items-center">
                    Ladang Bukit Serok Report
                </a>
            </div>
            <a href="estates.html" class="text-green-800 hover:text-green-900 transition duration-300">&larr; Back to Estates List</a>
        </nav>
    </header>

    <!-- Main container for the report -->
    <div class="container mx-auto p-4 md:p-8">
        <!-- Container where the estate data will be rendered -->
        <div id="selected-estate-container" class="grid grid-cols-1 gap-8">
             <!-- Content will be generated by JavaScript -->
        </div>
    </div>
    
    <!-- Modal for displaying policy details -->
    <div id="policyModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-2xl font-bold">Agricultural Policy Cross-Reference</h3>
                <button onclick="closePolicyModal()" class="text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
            </div>
            <div id="modalContent" class="space-y-4 overflow-y-auto pr-4 flex-grow">
                <!-- Modal content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Main script for application logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA STORE ---
            const estateData = {
                "id": "bukitserok",
                "name": "Ladang Bukit Serok",
                "reportInfo": "Data based on PA Report (October 2025) & Agronomy Report (August 2025).",
                "summaryMetrics": {
                    "area": {
                        "title": "Estate Area",
                        "lines": [
                            "Total Planted: 2,226.40 ha",
                            "Mature: 2,058.80 ha",
                            "FEHB Division: 167.60 ha"
                        ]
                    },
                    "yield": {
                        "title": "Yield/Ha (Actual vs Budget)",
                        "value": "18.00 / 15.09 MT",
                        "note": "YTD Sept 2025 (PAR Pg. 47)"
                    },
                    "cost": {
                        "title": "FFB Cost/Tonne (Actual vs Budget)",
                        "value": "RM 199.77 / RM 285.23",
                        "note": "Ex-Estate, YTD Sept 2025 (PAR Pg. 47)"
                    },
                    "labour": {
                        "title": "Labour Status",
                        "value": "Shortage of 8 Harvesters",
                        "note": "Total Workers: 154 (PAR Pg. 12)"
                    },
                     "pests": {
                        "title": "Pest & Disease Status",
                        "value": "Bagworm Controlled",
                        "note": "Ganoderma Spreading (PAR Pg. 31)"
                    }
                },
                "keyMetrics": [
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-blue-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z' /></svg>", "label": "Labour Ratio", "value": "1:14.5 ha (154 Workers)" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z' /></svg>", "label": "P&D Status", "value": "Ganoderma Rising" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-yellow-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 10V3L4 14h7v7l9-11h-7z' /></svg>", "label": "OER % (YTD)", "value": "19.34% (Sept 2025)" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z' /></svg>", "label": "Harvester Prod.", "value": "2.40 MT/md (Acceptable)" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-purple-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z' /></svg>", "label": "Harvest Interval", "value": "15 days (Acceptable)" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-teal-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17.657 18.343A8 8 0 016.343 7.029m11.314 11.314a8 8 0 01-11.314-11.314m2.121 13.435a2 2 0 01-2.828 0l-2.122-2.121a2 2 0 010-2.828l5.656-5.657a2 2 0 012.829 0l2.121 2.121a2 2 0 010 2.828l-5.657 5.657z' /></svg>", "label": "Nutrient Status", "value": "Deficient N, K & Mg" }
                ],
                "chartData": {
                    "production": {
                        "labels": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                        "ffb": [3737, 3644, 4648, 5239, 6221, 5972, 6276, 6025, 5911, 5004, 4201, 3546],
                        "rainfall": [232, 151, 97, 289, 155.5, 83, 30, 125, 122, 0, 0, 0],
                        "note": "*Rainfall data is YTD 2025. FFB Production data is 2024 (Pending 2025 monthly breakdown)."
                    },
                    "ageProfile": {
                        "labels": ["0-3 Years", "4-7 Years", "8-19 Years (Prime)", "20-25 Years (Old)", ">26 Years"],
                        "data": [0, 0, 62.8, 37.2, 0],
                        "title": "Ladang Bukit Serok - Palm Age Distribution (2025)",
                        "note": "*Source: PA Report 2/2025, Pg. 10."
                    }
                },
                "observations": [
                    "<b>Delayed Manuring Program:</b> Manuring programs (Mix A, B, NK1) scheduled for July 2025 have not been completed as of September. Delays are undesirable and must be expedited. <span class='observation-ref'>(PAR Pg. 33, 47; AR Pg. 11-13)</span>",
                    "<b>Harvester Shortage & Productivity:</b> The estate faces a shortage of 8 harvesters. While productivity has improved to 2.40 MT/man-day, it remains slightly below the target of 2.50 MT. <span class='observation-ref'>(PAR Pg. 12, 46)</span>",
                    "<b>Pest & Disease Trends:</b> Ganoderma infection is spreading in P00A, P00B, and P04J (<2% but rising). Rat damage shows old symptoms, but baiting is active. Bagworm infestation is currently under control. <span class='observation-ref'>(PAR Pg. 30-31; AR Pg. 6, 45)</span>",
                    "<b>Field Upkeep (Roads):</b> Road grading is 82% completed for the year, but surfacing with laterite or crusher run has not been carried out. Roadside drains need construction in soggy stretches. <span class='observation-ref'>(PAR Pg. 23, 46)</span>",
                    "<b>Harvesting Standards:</b> Harvesting interval is maintained at 15 days. However, loose fruits are missed in isolated areas, and functional fronds have been excessively removed in young mature areas. <span class='observation-ref'>(PAR Pg. 35-36, 47)</span>",
                    "<b>Declining Palm Health:</b> Previous foliar analysis (May 2025) indicated deficient Nitrogen, Potassium, and Magnesium levels in several blocks, impacting future yields. <span class='observation-ref'>(AR Pg. 31-32)</span>"
                ],
                "reports": {
                    "plantation": {
                        "Executive Summary": "Performance is acceptable. YTD FFB production (37,056 MT) is 19% higher than budget. Production cost (RM 199.77/MT) is 30% lower than budget. Key challenges include a shortage of 8 harvesters and delayed manuring programs. (Source: PAR Pg. 46-48)",
                        "Area Statement": "Total planted area is 2,226.40 ha. The composition is 37.2% Old Mature palms (P01A, P02B, P04J) and 62.8% Prime Mature palms. No changes since the last visit. (Source: PAR Pg. 10)",
                        "Labour Statement": "Total workforce is 154 (122 Checkroll, 22 Contract). There is a shortage of 8 harvesters. Harvester productivity is 2.40 MT/man-day. (Source: PAR Pg. 12)",
                        "Staff Establishment": "Staff complement is satisfactory. New Cadet Executive appointed in July 2025. (Source: PAR Pg. 14)",
                        "General Charges": "Expenditure is 22% lower than budget. Overspending noted in Executive Vehicle Running (old Hilux) and Burglary Insurance (underestimate). (Source: PAR Pg. 16)",
                        "Upkeep and Cultivation": "Weeding cost (RM 153.36/ha) is 11% below budget. Road grading is 82% complete but lacks laterite surfacing. Manuring (Mix A, B, NK1) scheduled for July is delayed. (Source: PAR Pg. 18-34)",
                        "Harvesting and Collection": "Cost per tonne (RM 46.29) is acceptable. Harvesting interval is 15 days. Mechanized collection covers 100% of the area (Timac & Mini Crawler). Loose fruit collection needs improvement. (Source: PAR Pg. 35, 41)",
                        "Crop Production": "YTD September FFB production is 37,056.24 MT, which is 19% higher than budget but 14% lower than the same period last year. Yield/ha is 18.00 MT. (Source: PAR Pg. 39)",
                        "Production Cost": "Ex-estate cost per tonne (RM 199.77) is 30% lower than budget. Lower costs in General Charges (-35%) and Upkeep (-48%) contributed to savings. (Source: PAR Pg. 43)",
                        "Vehicles Running Cost": "Toyota Hilux running cost was 3% higher than budget due to new tyres/insurance. Tractor running cost was 36% lower than budget. (Source: PAR Pg. 45)",
                        "Capital Expenditure": "No capital expenditure was incurred during the period under review. (Source: PAR Pg. 44)",
                        "Immature": "N/A - All areas are mature."
                    },
                    "agronomy": {
                        "Executive Summary": "As of July 2025, yield is 21% lower than 2024 due to seasonal factors. Key issues are the delayed 2025 manuring program (42% complete), poor application quality, and high rat damage exceeding thresholds. Bagworm infestations from earlier in the year have been suppressed. Ganoderma is a localized issue requiring sanitation monitoring. (Source: AR, Pg. 4-6)",
                        "Nutrient Inputs/Progress of Manuring": "Manuring progress is behind schedule at 42% completion by July 2025. Fertilizer application quality is poor, with narrow bands and improper placement. The fertilizer store roof has holes risking water damage. Excessive EFB application in Block B2 (83 MT/ha) increases Ganoderma risk. (Source: AR, Pg. 11-14)",
                        "Agronomic Observation": "Harvesting intervals are acceptable, but crop recovery is poor in under-pruned areas (P02B). The estate has a shortage of 8 harvesters. Pruning is ~50% complete but localized under-pruning persists. Leaf analysis from May 2025 shows declining N, K, and Mg levels. Rat damage is high, but bagworms are controlled. Ganoderma requires sanitation improvement as de-boling pits are too small. (Source: AR, Pg. 19-49)",
                        "Yield Performance": "YTD July 2025 yield is 12.75 mt/ha, a 21% decline from 2024. The decline is sharpest in field P02B (-30.1%). While production is trending up, it remains below 2024 levels. Promising bunch sets are observed for H2 2025. (Source: AR, Pg. 53-55)",
                        "Fertilizer Recommendation": "The 2026 fertilizer program is formulated based on leaf analysis and field conditions. Manuring will be withdrawn for blocks P01 A4 & A5, which are scheduled for replanting in 2027. Timely completion of the 2025 program is critical. (Source: AR, Pg. 56-57)"
                    },
                    "pinfosys": "Not Available"
                },
                "policy": " <div class='policy-item'><p class='font-semibold'>Pest & Disease Control</p><p class='text-sm text-gray-600'><b>Policy Ref: P&D-Rat-01:</b> Conduct quarterly census. If damage >10%, initiate baiting campaign with 2nd-gen rodenticides.</p><p class='text-sm text-gray-600'><b>Policy Ref: P&D-Gano-01:</b> Implement sanitation by de-boling (1.5m x 1.5m x 1.5m pit) for Ganoderma-infected palms to reduce spread.</p></div> <div class='policy-item'><p class='font-semibold'>Manuring & Fertilizing</p><p class='text-sm text-gray-600'><b>Policy Ref: FERT-APP-05:</b> All fertilizer applications must be completed according to the schedule. Any delays beyond 15 days must be reported with a mitigation plan.</p></div> <div class='policy-item'><p class='font-semibold'>Labour Productivity</p><p class='text-sm text-gray-600'><b>Policy Ref: HR-PROD-02:</b> Estates must monitor harvester productivity against a target of >2.5 tons/man-day. Implement training or review mechanization if consistently below target.</p></div> <div class='policy-item'><p class='font-semibold'>Field Upkeep</p><p class='text-sm text-gray-600'><b>Policy Ref: MAINT-PRUNE-02:</b> Progressive pruning must be consistently implemented. Under-pruned conditions in tall palm areas must be rectified within one harvesting cycle.</p></div>"
            };


            // --- GLOBAL VARIABLES ---
            let chartInstances = {};
            const container = document.getElementById('selected-estate-container');

            // --- FUNCTIONS ---
            function renderEstate() {
                container.innerHTML = createEstateHTML(estateData);
                setTimeout(() => {
                    initializeChartsForEstate(estateData);
                    populateInternalDropdowns(estateData);
                    attachEventListeners(estateData);
                }, 0);
            }

            function createEstateHTML(estate) {
                const summaryMetricsHTML = Object.values(estate.summaryMetrics).map(metric => {
                    const colorClass = metric.title.includes('Area') ? 'bg-blue-50 text-blue-800' : 
                                       metric.title.includes('Yield') ? 'bg-green-50 text-green-800' :
                                       metric.title.includes('Cost') ? 'bg-orange-50 text-orange-800' :
                                       metric.title.includes('Labour') ? 'bg-red-50 text-red-800' : 'bg-yellow-50 text-yellow-800';
                    if (metric.lines) {
                        return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3>${metric.lines.map(line => `<p class="text-sm">${line}</p>`).join('')}</div>`;
                    }
                    return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3><p class="text-2xl font-bold">${metric.value}</p><p class="text-xs text-gray-500 mt-1">${metric.note}</p></div>`;
                }).join('');

                const keyMetricsHTML = estate.keyMetrics.map(metric => `
                    <div class="flex items-center space-x-3 bg-gray-50 p-3 rounded-lg">
                        <div class="bg-gray-100 p-2 rounded-full">${metric.icon}</div>
                        <div><p class="text-sm text-gray-500">${metric.label}</p><p class="font-bold text-lg">${metric.value}</p></div>
                    </div>`).join('');

                const observationsHTML = estate.observations.map(obs => `<li class="ml-4">${obs}</li>`).join('');

                return `
                    <div class="bg-white p-6 rounded-lg shadow-lg animate-fade-in">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900">${estate.name}</h2>
                        <p class="text-sm text-gray-500 mb-6 italic">${estate.reportInfo}</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-8">${summaryMetricsHTML}</div>
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-4 border-b pb-2">Key Metrics & Agronomic Status</h3><div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-4">${keyMetricsHTML}</div></div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <div><h3 class="text-xl font-semibold mb-2">Monthly Production vs Rainfall (2025)</h3><div class="chart-container"><canvas id="prodChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.production.note}</p></div>
                            <div><h3 class="text-xl font-semibold mb-2">Palm Age Profile</h3><div class="pie-chart-container"><canvas id="ageChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.ageProfile.note}</p></div>
                        </div>
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-2 border-b pb-2">Key Observations & Issues</h3><ul class="list-disc list-inside space-y-2 text-gray-700 mt-4">${observationsHTML}</ul></div>
                        <div class="mb-8 text-center"><button class="policy-modal-btn bg-green-800 text-white px-6 py-3 rounded-lg hover:bg-green-900 transition shadow-md">View Agricultural Policy Cross-Reference</button></div>
                        <div class="space-y-2">
                            <button data-dropdown-id="${estate.id}-plantation" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Plantation Advisory Report Details</button>
                            <div id="${estate.id}-plantation" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                            <button data-dropdown-id="${estate.id}-agronomy" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Agronomy Report Details</button>
                            <div id="${estate.id}-agronomy" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                             <button data-dropdown-id="${estate.id}-pinfosys" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Pinfosys Report Details</button>
                            <div id="${estate.id}-pinfosys" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                        </div>
                    </div>`;
            }

            function initializeChartsForEstate() {
                const prodCanvasId = `prodChart-${estateData.id}`;
                const ageCanvasId = `ageChart-${estateData.id}`;
                if (chartInstances[prodCanvasId]) chartInstances[prodCanvasId].destroy();
                if (chartInstances[ageCanvasId]) chartInstances[ageCanvasId].destroy();

                const prodCtx = document.getElementById(prodCanvasId)?.getContext('2d');
                if(prodCtx) {
                    chartInstances[prodCanvasId] = new Chart(prodCtx, {
                        type: 'bar',
                        data: {
                            labels: estateData.chartData.production.labels,
                            datasets: [
                                { label: 'FFB Production (MT) - 2024', data: estateData.chartData.production.ffb, type: 'line', borderColor: '#ca8a04', backgroundColor: 'transparent', yAxisID: 'y-ffb', tension: 0.4 },
                                { label: 'Rainfall (mm) - 2025', data: estateData.chartData.production.rainfall, backgroundColor: '#3b82f6', yAxisID: 'y-rainfall' }
                            ]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { x: { grid: { display: false } }, 'y-ffb': { type: 'linear', position: 'left', title: { display: true, text: 'FFB Production (MT)' } }, 'y-rainfall': { type: 'linear', position: 'right', title: { display: true, text: 'Rainfall (mm)' }, grid: { drawOnChartArea: false } } } }
                    });
                }

                const ageCtx = document.getElementById(ageCanvasId)?.getContext('2d');
                if(ageCtx) {
                    chartInstances[ageCanvasId] = new Chart(ageCtx, {
                        type: 'pie',
                        data: {
                            labels: estateData.chartData.ageProfile.labels,
                            datasets: [{ data: estateData.chartData.ageProfile.data, backgroundColor: ['#fde047', '#facc15', '#eab308', '#ca8a04', '#a16207'], hoverOffset: 4 }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: estateData.chartData.ageProfile.title, font: { size: 16 } }, legend: { position: 'right' } } }
                    });
                }
            }
            
            function populateInternalDropdowns() {
                const agronomyDiv = document.getElementById(`${estateData.id}-agronomy`);
                const plantationDiv = document.getElementById(`${estateData.id}-plantation`);
                const pinfosysDiv = document.getElementById(`${estateData.id}-pinfosys`);

                if (agronomyDiv && estateData.reports.agronomy) {
                    agronomyDiv.innerHTML = Object.entries(estateData.reports.agronomy).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section.replace(/([A-Z])/g, ' $1').trim()}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                } else if (agronomyDiv) {
                    agronomyDiv.innerHTML = `<p class="text-sm text-gray-600">Not Available</p>`;
                }

                if (plantationDiv && estateData.reports.plantation) {
                    plantationDiv.innerHTML = Object.entries(estateData.reports.plantation).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section.replace(/([A-Z])/g, ' $1').trim()}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                } else if (plantationDiv) {
                    plantationDiv.innerHTML = `<p class="text-sm text-gray-600">Not Available</p>`;
                }
                
                if (pinfosysDiv) {
                     pinfosysDiv.innerHTML = `<p class="text-sm text-gray-600">Not Available</p>`;
                }
            }

            function attachEventListeners() {
                container.querySelectorAll('.dropdown-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.dropdownId;
                        const content = document.getElementById(id);
                        content.classList.toggle('active');
                        event.currentTarget.classList.toggle('active');
                    });
                });
                container.querySelector('.policy-modal-btn')?.addEventListener('click', openPolicyModal);
            }

            renderEstate();
        });
        
        function openPolicyModal() {
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            const policyData = estateData.policy;
            modalTitle.innerText = `Agricultural Policy Cross-Reference: ${estateData.name}`;
            modalContent.innerHTML = policyData;
            document.getElementById('policyModal').classList.add('active');
        }

        function closePolicyModal() {
            document.getElementById('policyModal').classList.remove('active');
        }
    </script>
</body>
</html>
