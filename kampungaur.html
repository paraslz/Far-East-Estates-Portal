<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Ladang Kampung Aur - Plantation and Agronomy Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .details-content { display: none; }
        .details-content.active { display: block; }
        .dropdown-btn.active { background-color: #14532d; }
        .policy-item { border-left: 3px solid #16a34a; padding-left: 1rem; margin-top: 0.75rem; }
        .modal { display: none; }
        .modal.active { display: flex; }
        .chart-container { position: relative; height: 300px; width: 100%; margin: auto; }
        .pie-chart-container { position: relative; height: 350px; width: 100%; margin: auto; }
        .observation-ref { font-size: 0.75rem; color: #57534e; font-style: italic; }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-md">
        <nav class="container mx-auto px-6 py-4 flex items-center justify-between">
            <div class="text-xl font-bold text-gray-900">
                <a href="index.html" class="flex items-center">
                    Ladang Kampung Aur Report
                </a>
            </div>
            <a href="estates.html" class="text-green-800 hover:text-green-900 transition duration-300">&larr; Back to Estates List</a>
        </nav>
    </header>

    <!-- Main container for the report -->
    <div class="container mx-auto p-4 md:p-8">
        <!-- Container where the estate data will be rendered -->
        <div id="selected-estate-container" class="grid grid-cols-1 gap-8">
             <!-- Content will be generated by JavaScript -->
        </div>
    </div>
    
    <!-- Modal for displaying policy details -->
    <div id="policyModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-2xl font-bold">Agricultural Policy Cross-Reference</h3>
                <button onclick="closePolicyModal()" class="text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
            </div>
            <div id="modalContent" class="space-y-4 overflow-y-auto pr-4 flex-grow">
                <!-- Modal content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Main script for application logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA STORE ---
            const estateData = {
                "id": "kampungaur",
                "name": "Ladang Kampung Aur",
                "reportInfo": "Data based on PA Report (August 2025) & Agronomy Report (September 2025).",
                "summaryMetrics": {
                    "area": {
                        "title": "Estate Area",
                        "lines": [
                            "Total Planted: 2,056.76 ha",
                            "Mature: 1,976.66 ha",
                            "Immature: 80.10 ha"
                        ]
                    },
                    "yield": {
                        "title": "Yield/Ha (YTD Jul '25 vs Budget)",
                        "value": "13.20 / 11.96 MT",
                        "note": "+10% ahead of budget (PAR)"
                    },
                    "cost": {
                        "title": "FFB Cost/Tonne (YTD Jul '25 vs Budget)",
                        "value": "RM 232.76 / RM 291.86",
                        "note": "20% lower than budget (PAR)"
                    },
                    "labour": {
                        "title": "Labour Status",
                        "value": "Critical Shortage",
                        "note": "Deficit of 18 harvesters"
                    },
                     "pruning": {
                        "title": "Pruning Status",
                        "value": "Unsatisfactory",
                        "note": "Behind schedule in old blocks"
                    }
                },
                "keyMetrics": [
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z' /></svg>", "label": "Labour Ratio", "value": "1:27 ha (Inadequate)" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-green-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' /></svg>", "label": "P&D Status", "value": "Under Control" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-yellow-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 10V3L4 14h7v7l9-11h-7z' /></svg>", "label": "OER % (YTD Jul '25)", "value": "19.02%" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-blue-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z' /></svg>", "label": "Harvester Prod.", "value": "2.70 MT/md" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-purple-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z' /></svg>", "label": "Harvest Interval", "value": "15-20+ days (Extended)" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17.657 18.343A8 8 0 016.343 7.029m11.314 11.314a8 8 0 01-11.314-11.314m2.121 13.435a2 2 0 01-2.828 0l-2.122-2.121a2 2 0 010-2.828l5.656-5.657a2 2 0 012.829 0l2.121 2.121a2 2 0 010 2.828l-5.657 5.657z' /></svg>", "label": "Manuring Status", "value": "Delayed (76% complete)" }
                ],
                "chartData": {
                    "production": {
                        "labels": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                        "ffb": [3328, 3558, 3966, 4326, 5077, 4674, 5479, 5360, 5194, 4164, 3965, 3597],
                        "rainfall": [430, 31, 65, 57, 165, 184, 95, 47, 148, 174, 227, 288],
                        "note": "*FFB production and rainfall data for Full Year 2024."
                    },
                    "ageProfile": {
                        "labels": ["Immature (0-3Y)", "Young Mature (4-7Y)", "Prime Mature (8-18Y)", "Old Mature (>19Y)"],
                        "data": [4.0, 13.4, 43.7, 38.8], // Simplified from 4.01, etc.
                        "title": "Ladang Kampung Aur - Palm Age Distribution",
                        "note": "*Source: PA Report 02/2025, Pg. 10."
                    }
                },
                 "observations": [
                    "<b>Harvester Shortage & Extended Intervals:</b> A critical deficit of harvesters (ratio 1:27 ha) has led to extended harvesting intervals, exceeding 20 days in some blocks, impacting crop recovery. <span class='observation-ref'>(PAR Pg. 13, 59; AR Pg. 19)</span>",
                    "<b>Unsatisfactory Pruning:</b> The pruning regime is unsatisfactory, particularly in old mature areas (B1, B2, B3) where dry, hanging fronds are common. This recurring issue hinders harvesting efficiency. <span class='observation-ref'>(PAR Pg. 60; AR Pg. 5, 23)</span>",
                    "<b>Delayed & Sub-Optimal Manuring:</b> The 2025 manuring program is behind schedule (76% complete as of Aug '25). Foliar analysis indicates low Nitrogen and Magnesium in several blocks, requiring attention. <span class='observation-ref'>(PAR Pg. 39, 60; AR Pg. 13, 31)</span>",
                    "<b>Poor EFB Application:</b> While EFB application is ongoing, quality is unsatisfactory due to inefficient distribution and inadequate levelling. Broader, rotational application across more blocks is recommended. <span class='observation-ref'>(AR Pg. 17)</span>",
                    "<b>Deteriorating Weeding & Upkeep:</b> Noxious weeds are prevalent in some areas. Road surfacing is still pending, and drain desilting is behind schedule, which is critical as flooding remains a challenge. <span class='observation-ref'>(PAR Pg. 22, 26, 60; AR Pg. 6)</span>",
                    "<b>Immature Area (P21S) Concerns:</b> Palms in the immature block show uneven growth due to flooding and a prolonged planting period. Supplying must be expedited. <span class='observation-ref'>(PAR Pg. 51-54, 61; AR Pg. 61)</span>",
                    "<b>Mixed Yield Performance:</b> While YTD July performance was ahead of budget, the cumulative yield as of August 2025 (15.72 Mt/ha) marks a 13.17% decline compared to the previous year, mainly due to flooding affecting key blocks. <span class='observation-ref'>(PAR Pg. 45; AR Pg. 67)</span>"
                ],
                "reports": {
                    "plantation": {
                        "Executive Summary": "The estate's performance is acceptable with production ahead of budget and costs below budget. However, the quality of fieldwork requires significant improvement. Critical issues include a severe harvester shortage, unsatisfactory pruning quality in old areas, delayed manuring, and inconsistent weeding. These operational lapses must be addressed to sustain performance. (Source: PAR, Pg. 59-61)",
                        "Area Statement": "Total planted area is 1,998.3 ha, consisting of 1,918.2 ha mature palms and 80.1 ha immature. A significant portion (38.8%) of palms are old mature (>19 years). (Source: PAR, Pg. 10)",
                        "Labour Statement": "There is a critical shortage of 18 harvesters, resulting in an inadequate ratio of 1 harvester to 27 ha. The total workforce has decreased by 8 people since the last visit. (Source: PAR, Pg. 12-13)",
                        "Staff Establishment": "Staff complement is satisfactory. The Manager and one Conductor are scheduled for retirement in late 2025. (Source: PAR, Pg. 14-15)",
                        "General Charges": "As of July, expenditure is 12% lower than budget. Overspending on specific items like Executive Salaries, Bonuses, and Recruitment has been justified. (Source: PAR, Pg. 16-18)",
                        "Upkeep and Cultivation": "Weeding quality in low-lying areas has deteriorated. Road grading is complete, but surfacing with crusher run has not commenced. Drain desilting is behind schedule. Pruning in old mature blocks is unsatisfactory with many dried fronds. The July manuring program for Mixture A and B is incomplete. (Source: PAR, Pg. 19-40)",
                        "Harvesting and Collection": "The harvesting interval of ~15 days is acceptable. However, standards require improvement to ensure complete loose fruit collection and to prevent over-pruning in young mature areas. (Source: PAR, Pg. 41-44)",
                        "Crop Production": "FFB production as of July is 25,323.68 MT, which is 10% higher than budget. The yield per hectare is 13.20 MT. (Source: PAR, Pg. 45)",
                        "Production Cost": "The ex-estate cost per tonne as of July is RM 232.76, which is 20% lower than the seasonal budget, primarily due to higher crop production. (Source: PAR, Pg. 49-50)",
                        "Immature P21S (80.1 ha)": "Palm supplying is still ongoing and needs to be completed before the area is classified as mature in 2026. Noxious weeds and rat damage require control measures. The manuring program is delayed. Scout harvesting has been successful, yielding 102% more than budgeted. (Source: PAR, Pg. 51-56)"
                    },
                    "agronomy": {
                        "Executive Summary": "Yield as of August 2025 is 15.72 Mt/ha, a 13.17% decline from 2024, largely due to flooding. The 2025 manuring program is 76% complete but delayed. Pruning in old plantings remains incomplete and is hindering harvesting. Pest and disease status is generally under control, but monitoring is required. The immature block (P21S) shows uneven growth. (Source: AR, Pg. 4-7, 67, 69-70)",
                        "Nutrient Inputs/Progress of Manuring": "As of August 2025, 76% of the annual program was completed. Mixture B and C applications are outstanding, with some applications delayed by over 2 months. A wet floor in the fertilizer store requires corrective action to prevent spoilage. (Source: AR, Pg. 13-14)",
                        "Agronomic Observation": "Harvesting intervals are extended, exceeding 20 days in some blocks (e.g., P12H), due to a harvester deficit. Under-pruning with dry hanging fronds persists in old blocks (B1, B2, B3). Foliar analysis revealed Magnesium and Nitrogen deficiencies in several blocks. Weeding is generally acceptable but requires follow-up on jungle woodies. Rat damage has decreased significantly post-baiting. (Source: AR, Pg. 19, 23, 31, 34, 47)",
                        "By-Product/Biowaste Applications": "A total of 16,906 Mt of EFB was applied in 2025, mainly in blocks P02A and P03C. It is recommended to expand EFB application to other blocks on a rotational basis to improve soil health more broadly and avoid over-application. Application quality was unsatisfactory with poor distribution in the field. (Source: AR, Pg. 16-17)",
                        "Yield Performance": "YTD August 2025 yield was 15.72 Mt/ha, a 13.17% decline from the same period last year. The shortfall is largely attributed to seasonal factors and significant flooding in block P12H, which saw a 33% yield drop and completed only 14 harvesting rounds instead of the targeted 16. In contrast, the young mature block P20F showed a 49% yield increase due to age factor. (Source: AR, Pg. 67-68)",
                        "Fertilizer Recommendation (2026)": "The 2026 program will utilize a combination of mixture and straight fertilizers. Fertilizer application will be withdrawn from blocks P00/B1 and B2 in preparation for their replanting in 2027. (Source: AR, Pg. 71-72)"
                    },
                     "pinfosys": "Not Available"
                },
                 "policy": " <div class='policy-item'><p class='font-semibold'>Labour Management</p><p class='text-sm text-gray-600'><b>Policy Ref: HR-MANPOWER-01:</b> Estate managers must maintain the budgeted worker-to-land ratio. A harvester-to-hectare ratio of 1:27 is considered inadequate and requires an immediate recruitment plan.</p></div> <div class='policy-item'><p class='font-semibold'>Pruning in Old Mature Areas</p><p class='text-sm text-gray-600'><b>Policy Ref: PRUNE-OLD-01:</b> In palms older than 19 years, pruning must be prioritized to remove all dry and hanging fronds to prevent obstruction, improve harvesting efficiency, and reduce pest habitats.</p></div> <div class='policy-item'><p class='font-semibold'>Manuring & Fertilizing</p><p class='text-sm text-gray-600'><b>Policy Ref: FERT-APP-05:</b> All fertilizer applications must be completed according to the schedule. Any delays beyond 15 days must be reported with a mitigation plan.</p></div><div class='policy-item'><p class='font-semibold'>EFB Application</p><p class='text-sm text-gray-600'><b>Policy Ref: FERT-EFB-02:</b> EFB application should be planned on a rotational basis across multiple blocks to maximize agronomic benefits and avoid potential issues from over-application in a single area.</p></div> <div class='policy-item'><p class='font-semibold'>Upkeep of Immature Areas</p><p class='text-sm text-gray-600'><b>Policy Ref: UPKEEP-IM-03:</b> Supplying of vacant points must be completed at least 6 months before an immature area is scheduled to be declared mature.</p></div>"
            };


            // --- GLOBAL VARIABLES ---
            let chartInstances = {};
            const container = document.getElementById('selected-estate-container');

            // --- FUNCTIONS ---
            function renderEstate() {
                container.innerHTML = createEstateHTML(estateData);
                setTimeout(() => {
                    initializeChartsForEstate(estateData);
                    populateInternalDropdowns(estateData);
                    attachEventListeners(estateData);
                }, 0);
            }

            function createEstateHTML(estate) {
                const summaryMetricsHTML = Object.values(estate.summaryMetrics).map(metric => {
                    const colorClass = metric.title.includes('Area') ? 'bg-blue-50 text-blue-800' : 
                                       metric.title.includes('Yield') ? 'bg-green-50 text-green-800' :
                                       metric.title.includes('Cost') ? 'bg-orange-50 text-orange-800' :
                                       metric.title.includes('Labour') ? 'bg-red-50 text-red-800' : 'bg-yellow-50 text-yellow-800';
                    if (metric.lines) {
                        return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3>${metric.lines.map(line => `<p class="text-sm">${line}</p>`).join('')}</div>`;
                    }
                    return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3><p class="text-2xl font-bold">${metric.value}</p><p class="text-xs text-gray-500 mt-1">${metric.note}</p></div>`;
                }).join('');

                const keyMetricsHTML = estate.keyMetrics.map(metric => `
                    <div class="flex items-center space-x-3 bg-gray-50 p-3 rounded-lg">
                        <div class="bg-gray-100 p-2 rounded-full">${metric.icon}</div>
                        <div><p class="text-sm text-gray-500">${metric.label}</p><p class="font-bold text-lg">${metric.value}</p></div>
                    </div>`).join('');

                const observationsHTML = estate.observations.map(obs => `<li class="ml-4">${obs}</li>`).join('');

                return `
                    <div class="bg-white p-6 rounded-lg shadow-lg animate-fade-in">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900">${estate.name}</h2>
                        <p class="text-sm text-gray-500 mb-6 italic">${estate.reportInfo}</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-8">${summaryMetricsHTML}</div>
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-4 border-b pb-2">Key Metrics & Agronomic Status</h3><div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-4">${keyMetricsHTML}</div></div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <div><h3 class="text-xl font-semibold mb-2">Monthly Production vs Rainfall (2024)</h3><div class="chart-container"><canvas id="prodChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.production.note}</p></div>
                            <div><h3 class="text-xl font-semibold mb-2">Palm Age Profile</h3><div class="pie-chart-container"><canvas id="ageChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.ageProfile.note}</p></div>
                        </div>
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-2 border-b pb-2">Key Observations & Issues</h3><ul class="list-disc list-inside space-y-2 text-gray-700 mt-4">${observationsHTML}</ul></div>
                        <div class="mb-8 text-center"><button class="policy-modal-btn bg-green-800 text-white px-6 py-3 rounded-lg hover:bg-green-900 transition shadow-md">View Agricultural Policy Cross-Reference</button></div>
                        <div class="space-y-2">
                            <button data-dropdown-id="${estate.id}-plantation" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Plantation Advisory Report Details</button>
                            <div id="${estate.id}-plantation" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                            <button data-dropdown-id="${estate.id}-agronomy" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Agronomy Report Details</button>
                            <div id="${estate.id}-agronomy" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                            <button data-dropdown-id="${estate.id}-pinfosys" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Pinfosys Report Details</button>
                            <div id="${estate.id}-pinfosys" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                        </div>
                    </div>`;
            }

            function initializeChartsForEstate() {
                const prodCanvasId = `prodChart-${estateData.id}`;
                const ageCanvasId = `ageChart-${estateData.id}`;
                if (chartInstances[prodCanvasId]) chartInstances[prodCanvasId].destroy();
                if (chartInstances[ageCanvasId]) chartInstances[ageCanvasId].destroy();

                const prodCtx = document.getElementById(prodCanvasId)?.getContext('2d');
                if(prodCtx) {
                    chartInstances[prodCanvasId] = new Chart(prodCtx, {
                        type: 'bar',
                        data: {
                            labels: estateData.chartData.production.labels,
                            datasets: [
                                { label: 'FFB Production (MT)', data: estateData.chartData.production.ffb, type: 'line', borderColor: '#ca8a04', backgroundColor: 'transparent', yAxisID: 'y-ffb', tension: 0.4 },
                                { label: 'Rainfall (mm)', data: estateData.chartData.production.rainfall, backgroundColor: '#3b82f6', yAxisID: 'y-rainfall' }
                            ]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { x: { grid: { display: false } }, 'y-ffb': { type: 'linear', position: 'left', title: { display: true, text: 'FFB Production (MT)' } }, 'y-rainfall': { type: 'linear', position: 'right', title: { display: true, text: 'Rainfall (mm)' }, grid: { drawOnChartArea: false } } } }
                    });
                }

                const ageCtx = document.getElementById(ageCanvasId)?.getContext('2d');
                if(ageCtx) {
                    chartInstances[ageCanvasId] = new Chart(ageCtx, {
                        type: 'pie',
                        data: {
                            labels: estateData.chartData.ageProfile.labels,
                            datasets: [{ data: estateData.chartData.ageProfile.data, backgroundColor: ['#fde047', '#facc15', '#eab308', '#ca8a04'], hoverOffset: 4 }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: estateData.chartData.ageProfile.title, font: { size: 16 } }, legend: { position: 'right' } } }
                    });
                }
            }
            
            function populateInternalDropdowns() {
                const agronomyDiv = document.getElementById(`${estateData.id}-agronomy`);
                const plantationDiv = document.getElementById(`${estateData.id}-plantation`);
                const pinfosysDiv = document.getElementById(`${estateData.id}-pinfosys`);

                if (agronomyDiv && estateData.reports.agronomy) {
                    agronomyDiv.innerHTML = Object.entries(estateData.reports.agronomy).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section.replace(/([A-Z])/g, ' $1').trim()}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                } else if (agronomyDiv) {
                    agronomyDiv.innerHTML = `<p class="text-sm text-gray-600">Not Available</p>`;
                }

                if (plantationDiv && estateData.reports.plantation) {
                    plantationDiv.innerHTML = Object.entries(estateData.reports.plantation).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section.replace(/([A-Z])/g, ' $1').trim()}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                } else if (plantationDiv) {
                    plantationDiv.innerHTML = `<p class="text-sm text-gray-600">Not Available</p>`;
                }
                
                if (pinfosysDiv && estateData.reports.pinfosys === "Not Available") {
                    pinfosysDiv.innerHTML = `<p class="text-sm text-gray-600">Not Available</p>`;
                }
            }

            function attachEventListeners() {
                container.querySelectorAll('.dropdown-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.dropdownId;
                        const content = document.getElementById(id);
                        content.classList.toggle('active');
                        event.currentTarget.classList.toggle('active');
                    });
                });
                container.querySelector('.policy-modal-btn')?.addEventListener('click', openPolicyModal);
            }

            renderEstate();
        });
        
        function openPolicyModal() {
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            const policyData = estateData.policy;
            modalTitle.innerText = 'Agricultural Policy Cross-Reference: ' + estateData.name;
            modalContent.innerHTML = policyData;
            document.getElementById('policyModal').classList.add('active');
        }

        function closePolicyModal() {
            document.getElementById('policyModal').classList.remove('active');
        }
    </script>
</body>
</html>
